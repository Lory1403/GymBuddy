import{l as p}from"./loggedUser-8bd3ef49.js";import{_ as d}from"./_plugin-vue_export-helper-c27b6911.js";import{o as i,c as l,a,F as h,g,t as r}from"./index-03c78cd7.js";const _={}.VITE_API_HOST||"http://localhost:8080",m=_+"/api/v1",f={data(){return{palestre:[],position:null,distanze:[]}},methods:{getPalestre(){fetch(m+"/palestre",{method:"GET",headers:{"Content-Type":"application/json","x-access-token":p.token,latitude:this.position.coords.latitude,longitude:this.position.coords.longitude}}).then(async e=>{let t=await Promise.resolve(e.json());this.palestre=t.palestre,this.distanze=t.distanze}).catch(e=>console.error(e))},getIndirizzo(e){console.log(e);let t="";return console.log(e.via),e.via&&(t+=e.via),e.numeroCivico&&(t+=" "+e.numeroCivico+","),e.cap&&(t+=" "+e.cap),e.citta&&(t+=" "+e.citta),e.provincia&&(t+=" "+e.provincia),e.paese&&(t+=" "+e.paese),console.log(t),t},getDistanza(e){let t=this.distanze.map(n=>{if(n.id==e)return n});return Number(t[0].distanza.toFixed(2))},getLocation(){navigator.geolocation?navigator.geolocation.getCurrentPosition(this.showPosition,this.showError):alert("La geolocalizzazione non è supportata da questo browser.")},showPosition(e){this.position=e,this.getPalestre()},showError(e){switch(e.code){case e.PERMISSION_DENIED:alert("L'autorizzazione alla geolocalizzazione è stata negata dall'utente.");break;case e.POSITION_UNAVAILABLE:alert("Le informazioni sulla posizione non sono disponibili.");break;case e.TIMEOUT:alert("La richiesta per ottenere la posizione dell'utente è scaduta.");break;case e.UNKNOWN_ERROR:alert("Si è verificato un errore sconosciuto.");break}},handleClick(){this.$router.push("/palestra")},redirect(e){this.$router.push("/")}},created(){this.getLocation()}},v={class:"page"},k=a("h2",null,"Ecco le palestre vicino a te!",-1),b={class:"gym-list d-flex align-self-center flex-wrap justify-content-around"},E={class:"mb-2"},x={class:"mb-1"},I={class:"mb-3"};function L(e,t,n,y,c,s){return i(),l("div",v,[k,a("a",{class:"text-light",onClick:t[0]||(t[0]=(...o)=>s.getLocation&&s.getLocation(...o))},"ciao sono qua"),a("ul",b,[(i(!0),l(h,null,g(c.palestre,o=>(i(),l("li",{key:o.id,style:{"margin-right":"50px!important"},class:"d-flex align-items-center justify-content-center flex-column"},[a("h3",E,r(o.nome),1),a("p",x,r(s.getIndirizzo(o.indirizzo)),1),a("p",I,"Distanza: "+r(s.getDistanza(o.id))+" km",1),a("a",{href:"#",class:"btn btn-secondary btn-lg active",role:"button","aria-pressed":"true",onClick:t[1]||(t[1]=(...u)=>s.handleClick&&s.handleClick(...u))},"Esplora")]))),128))])])}const w=d(f,[["render",L]]);export{w as default};
